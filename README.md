# 单身狗论坛

除小以外，一无所有。

对PHP版本等环境要求，我不明确，个人在Windows PC上，运行搭载PHP 7.1+Apache的PHPStudy，成功运行。另外，你不需要搭建MySQL等数据库环境，它使用JSON数据库。

## 比起论坛，留言板更名副其实

这个单文件的程序，只有注册、登录、发帖、回帖，甚至不支持板块、管理员管理，说是留言板应该会更贴切。

## 说好的单文件，为什么会有好几个PHP文件？

只要任选一个即可，不必全部下载、上传，它们只是不同的版本。

* **all-in-dog.php** ：完全版，这是完全的论坛，看不懂对各个版本的描述的话，选它就对。
* **app-end.php** ：吐JSON版，与完全版比，这个版本返回的是JSON而不是HTML，且相比完全版缺少一些页面，适合前后端分离用。（不提供单独的前端文件，请自行开发）
* ~~**way-smaller.php** ：抛弃JSON数据库的完全版，使用PDO，使用SQLite.~~ 没有开发完毕。
* ~~**way-smallest.php** ：抛弃JSON数据库的吐JSON版，使用PDO，使用SQLite.~~

## 吐JSON版API说明

作为使用者，你大概没有耐心看完我的代码罢，所以，此处列出来各个API, 并说明使用方法。

路径 | 方法 | `GET`参数 | `POST`参数 | 描述
---- | ------ | ------ | ----- | ----
`/` | `GET` | 无参数 | 无参数 | 根目录，获取论坛名，以及帖子列表
`/view` | `GET` | `post`=帖子ID | 无参数 | 根据帖子ID，获取帖子的相关信息。
`/post` | `POST` | 无参数 | `title`=标题&`content`=内容 | 根据标题和内容，发布一个帖子。需要登录。
`/auth` | `POST` | 无参数 | `username`=用户名&`password`=密码&`register`=是否注册 | 根据用户名和密码，注册或登录账户，具体是注册还是登录由`isset($_POST['register'])`决定。
`/auth` | `DELETE` | 无参数 | 无参数 | 退出当前登录状态。
`/profile` | `GET` | `user`=用户ID | 无参数 | 如果有用户ID，则根据用户ID获取用户信息，否则，如果有登录，获取自己信息，否则，显示未登录错误。
`/reply` | `GET` | `reply`=回复ID | 无参数 | 根据霍夫ID，获取回复相关信息。
`/reply` | `POST` | `in`=帖子ID | `content`=内容 | 回复内容到帖子ID所指定的帖子。需要登录。

它们的返回值还需要你自己用不同参数探索，或者直接阅读源码。
如果你没有设置伪静态，请求`https://服务器/路径/app-end.php/路径`即可，如以`fetch`请求`/post`，可以这么写：

```js
fetch('/app-end.php/post', {
  method: 'POST',
  headers:{
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    title: '人类的本质是什么',
    content: '人类的本质是复读机'
  })
});
```

## 如何安装？

上传到服务器中任意目录，然后访问这个文件即可，数据库会自动生成。

如果要自定义论坛名称或其它信息，打开这些PHP文件，对前几行修改即可。
